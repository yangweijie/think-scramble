# 📝 更新日志

本文档记录了 ThinkScramble 的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划功能
- 🔄 GraphQL 支持
- 🔄 API 版本管理
- 🔄 自动化测试生成
- 🔄 性能基准测试

## [1.4.0] - 2024-01-26

### 新增功能 ✨

#### 🥧 PIE 支持
- 添加完整的 PIE (PHP Installer for Extensions) 支持
- 自动化安装、更新和卸载流程
- 跨平台兼容性（Linux、macOS、Windows）
- 智能配置管理和环境设置

#### 📦 跨平台 CLI
- 使用 PHPacker (Box) 构建跨平台可执行文件
- 支持 PHAR、Linux、macOS、Windows 多种格式
- 自动化构建流程和 CI/CD 集成
- 完整的安装脚本和使用文档

#### ⚡ 缓存优化
- 智能文件缓存系统，基于修改时间
- 内存缓存驱动支持
- 缓存统计和性能监控
- 增量解析和缓存命中率优化

#### 📈 性能监控
- 详细的性能指标收集
- 内存使用监控和分析
- 执行时间统计和报告
- 性能建议和优化提示

#### 🔌 插件系统
- 可扩展的插件架构
- 钩子系统支持自定义扩展
- 插件管理和依赖处理
- 15+ 个预定义钩子点

#### 👀 实时更新
- 文件变化监控和自动重新生成
- 批量变更处理和过滤
- 变更摘要和统计信息
- 支持多目录监控

#### 📤 多格式导出
- Postman Collection v2.1 导出
- Insomnia Workspace 导出
- 批量导出和格式验证
- 导出管理器统一接口

### 改进功能 🚀

#### 💻 CLI 工具增强
- 新增 `--watch` 实时监控选项
- 新增 `--stats` 统计信息显示
- 新增 `--validate` 配置验证
- 改进的错误处理和用户反馈

#### 🛡️ 安全分析增强
- 更准确的中间件识别
- 支持更多认证方案
- 安全配置验证
- 自动安全方案生成

#### 📊 模型分析改进
- 更好的关联关系处理
- 验证规则自动识别
- 字段类型推断优化
- 模型缓存和性能优化

### 修复问题 🐛

- 修复了复杂嵌套模型的解析问题
- 解决了某些中间件无法识别的问题
- 修复了缓存在 Windows 下的路径问题
- 改进了错误消息的准确性和可读性
- 修复了大型项目的内存使用问题

### 文档更新 📚

- 新增 PIE 安装和使用指南
- 完整的跨平台构建文档
- 性能优化最佳实践
- 插件开发指南
- 故障排除和 FAQ 更新

## [1.3.0] - 2024-01-15

### 新增功能 ✨

#### 🎯 注解系统增强
- 支持更多 OpenAPI 3.0 注解
- 改进的参数类型推断
- 嵌套对象和数组支持
- 自定义验证规则识别

#### 🔍 验证规则分析
- 自动识别 ThinkPHP 验证规则
- 转换为 OpenAPI Schema 约束
- 支持自定义验证器
- 验证错误消息提取

#### 📊 模型关联分析
- 自动识别模型关联关系
- 生成关联数据的 Schema
- 支持一对一、一对多、多对多关系
- 关联查询参数生成

### 改进功能 🚀

- 提升了大型项目的解析性能
- 优化了内存使用
- 改进了错误处理机制
- 增强了配置验证

### 修复问题 🐛

- 修复了某些注解解析错误
- 解决了路径参数识别问题
- 修复了响应格式生成错误

## [1.2.0] - 2024-01-01

### 新增功能 ✨

#### 🛡️ 中间件分析
- 自动识别控制器中间件
- 生成对应的安全方案
- 支持多种认证方式
- 中间件参数提取

#### 🎨 UI 界面支持
- Swagger UI 集成
- Stoplight Elements 支持
- 自定义主题配置
- 响应式设计

#### 📁 文件上传支持
- 文件上传参数识别
- multipart/form-data 支持
- 文件类型和大小限制
- 上传进度和错误处理

### 改进功能 🚀

- 改进了路由分析算法
- 优化了 Schema 生成逻辑
- 增强了错误消息提示
- 提升了整体稳定性

### 修复问题 🐛

- 修复了路由组前缀处理问题
- 解决了某些响应格式错误
- 修复了配置文件加载问题

## [1.1.0] - 2023-12-15

### 新增功能 ✨

#### 📝 基础注解支持
- `@summary` 接口摘要
- `@description` 详细描述
- `@param` 参数定义
- `@return` 返回值定义
- `@throws` 异常定义

#### 🔧 配置系统
- 灵活的配置文件支持
- 环境变量配置
- 默认配置和覆盖机制
- 配置验证和错误提示

#### 📊 基础 Schema 生成
- 自动类型推断
- 基础数据类型支持
- 数组和对象处理
- 可选和必需字段识别

### 改进功能 🚀

- 优化了代码解析性能
- 改进了错误处理
- 增强了日志记录
- 提升了用户体验

### 修复问题 🐛

- 修复了某些 PHP 8 兼容性问题
- 解决了路径解析错误
- 修复了配置加载问题

## [1.0.0] - 2023-12-01

### 首次发布 🎉

#### 核心功能
- 🚀 **零配置启动** - 安装即用，无需复杂配置
- 📝 **自动文档生成** - 基于代码自动生成 OpenAPI 文档
- 🎯 **ThinkPHP 原生支持** - 完全适配 ThinkPHP 6/8 架构
- 📊 **OpenAPI 3.0 标准** - 生成标准的 OpenAPI 文档

#### 基础功能
- 控制器方法自动识别
- 路由参数提取
- 基础类型推断
- JSON 格式输出
- 简单配置支持

#### 系统要求
- PHP >= 8.0
- ThinkPHP >= 6.0
- Composer

---

## 版本说明

### 版本号规则

ThinkScramble 遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范：

- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 发布周期

- **主版本**：每年 1-2 次，包含重大功能更新
- **次版本**：每月 1-2 次，包含新功能和改进
- **修订版本**：根据需要发布，主要修复问题

### 支持政策

- **当前版本**：完全支持，包含新功能和问题修复
- **前一个主版本**：安全更新和重要问题修复
- **更早版本**：不再维护，建议升级

### 升级指南

#### 从 1.3.x 升级到 1.4.x

1. **备份配置文件**
   ```bash
   cp scramble.php scramble.php.backup
   ```

2. **更新包**
   ```bash
   # PIE 方式
   pie update yangweijie/think-scramble
   
   # Composer 方式
   composer update yangweijie/think-scramble
   ```

3. **验证配置**
   ```bash
   scramble --validate --config=scramble.php
   ```

4. **测试功能**
   ```bash
   scramble --output=test-api.json
   ```

#### 配置变更

1.4.0 版本新增了以下配置选项：

```php
// 新增缓存配置
'cache' => [
    'driver' => 'file',
    'ttl' => 3600,
    'file' => [
        'path' => sys_get_temp_dir() . '/think-scramble-cache',
    ],
],

// 新增性能配置
'performance' => [
    'monitor' => true,
    'cache_analysis' => true,
],

// 新增插件配置
'plugins' => [
    'enabled' => [],
    'directories' => ['./plugins'],
],
```

### 贡献者

感谢所有为 ThinkScramble 做出贡献的开发者：

- [@yangweijie](https://github.com/yangweijie) - 项目创建者和主要维护者
- 以及所有提交问题、建议和代码的贡献者们

### 致谢

特别感谢以下项目的启发和支持：

- [Laravel Scramble](https://github.com/dedoc/scramble) - 原始灵感来源
- [ThinkPHP](https://github.com/top-think/framework) - 框架支持
- [OpenAPI](https://github.com/OAI/OpenAPI-Specification) - 规范标准
- [PHPStan](https://github.com/phpstan/phpstan) - 静态分析技术

---

📞 **问题反馈**: 如果你发现任何问题或有改进建议，请 [提交 Issue](https://github.com/yangweijie/think-scramble/issues)。
