# ThinkScramble 跨平台 CLI 使用指南

## 🎉 构建成功！

ThinkScramble 已成功打包为跨平台 CLI 可执行文件，支持 Linux、macOS 和 Windows 系统。

## 📦 生成的文件

```
dist/
├── scramble.phar              # 主要 PHAR 文件（跨平台）
├── scramble-linux             # Linux/macOS 可执行文件
├── scramble.bat               # Windows 批处理文件
├── scramble.ps1               # Windows PowerShell 脚本
├── install.sh                 # Linux/macOS 安装脚本
├── install.bat                # Windows 安装脚本
├── README.txt                 # 使用说明
└── think-scramble-1.4.0.zip   # 完整发布包
```

## 🚀 安装方式

### Linux/macOS 安装

#### 方法 1: 自动安装（推荐）
```bash
# 下载并安装
sudo ./dist/install.sh
```

#### 方法 2: 手动安装
```bash
# 复制到系统路径
sudo cp dist/scramble-linux /usr/local/bin/scramble
sudo chmod +x /usr/local/bin/scramble

# 验证安装
scramble --version
```

#### 方法 3: 本地使用
```bash
# 直接使用 PHAR 文件
php dist/scramble.phar --version

# 或使用 Linux 可执行文件
./dist/scramble-linux --version
```

### Windows 安装

#### 方法 1: 自动安装
```cmd
# 以管理员身份运行
dist\install.bat
```

#### 方法 2: 手动安装
```cmd
# 创建目录
mkdir %USERPROFILE%\bin

# 复制文件
copy dist\scramble.phar %USERPROFILE%\bin\
copy dist\scramble.bat %USERPROFILE%\bin\

# 添加到 PATH（可选）
# 将 %USERPROFILE%\bin 添加到系统 PATH 环境变量
```

#### 方法 3: 直接使用
```cmd
# 使用批处理文件
dist\scramble.bat --version

# 或直接使用 PHP
php dist\scramble.phar --version
```

## 💻 使用示例

### 基本用法

```bash
# 显示版本
scramble --version

# 显示帮助
scramble --help

# 生成基本文档
scramble --output=api.json

# 生成 YAML 格式文档
scramble --output=api.yaml
```

### 高级功能

```bash
# 包含中间件分析
scramble --output=api.json --middleware

# 指定控制器和模型目录
scramble --output=api.json --controllers=app/controller --models=app/model

# 导出为 Postman Collection
scramble --format=postman --output=api.postman.json

# 导出为 Insomnia Workspace
scramble --format=insomnia --output=api.insomnia.json

# 显示统计信息
scramble --stats

# 实时监控文件变化
scramble --watch --output=api.json

# 验证配置
scramble --validate --config=scramble.php
```

### 在 ThinkPHP 项目中使用

```bash
# 进入 ThinkPHP 项目目录
cd /path/to/your/thinkphp/project

# 生成完整的 API 文档
scramble --output=public/api.json --middleware --controllers=app/controller --models=app/model

# 监控开发时的文件变化
scramble --watch --output=public/api.json --middleware
```

## 🔧 配置文件

创建 `scramble.php` 配置文件：

```php
<?php

return [
    'info' => [
        'title' => 'My API',
        'version' => '1.0.0',
        'description' => 'API documentation generated by ThinkScramble',
    ],
    'servers' => [
        ['url' => 'http://localhost:8000', 'description' => 'Development server'],
        ['url' => 'https://api.example.com', 'description' => 'Production server'],
    ],
    'security' => [
        'enabled_schemes' => ['BearerAuth', 'ApiKeyAuth'],
    ],
    'cache' => [
        'driver' => 'file',
        'file' => [
            'path' => sys_get_temp_dir() . '/think-scramble-cache',
        ],
    ],
];
```

## 📊 性能特性

### 缓存优化
- 智能文件缓存，基于修改时间
- 内存缓存支持
- 缓存命中率统计

### 性能监控
- 执行时间统计
- 内存使用监控
- 性能建议

### 插件系统
- 可扩展的钩子系统
- 自定义插件支持
- 插件管理

## 🌍 跨平台兼容性

### 支持的系统
- ✅ Linux (x86_64, ARM64)
- ✅ macOS (Intel, Apple Silicon)
- ✅ Windows (x86_64)
- ✅ FreeBSD
- ✅ 其他 Unix-like 系统

### PHP 版本要求
- PHP 8.0+
- 推荐 PHP 8.1+

### 依赖要求
- 无需额外安装依赖
- 所有依赖已打包在 PHAR 中

## 🚨 故障排除

### 常见问题

#### 1. 权限错误
```bash
# Linux/macOS
chmod +x scramble-linux
sudo chmod +x /usr/local/bin/scramble

# Windows
# 以管理员身份运行命令提示符
```

#### 2. PHP 版本不兼容
```bash
# 检查 PHP 版本
php --version

# 如果版本过低，请升级 PHP 到 8.0+
```

#### 3. 内存不足
```bash
# 增加 PHP 内存限制
php -d memory_limit=512M scramble.phar --output=api.json
```

#### 4. 文件路径问题
```bash
# 使用绝对路径
/usr/local/bin/scramble --output=/full/path/to/api.json

# 或确保在正确的目录中运行
cd /path/to/thinkphp/project
scramble --output=api.json
```

### 调试模式

```bash
# 启用详细输出
scramble --output=api.json --verbose

# 显示性能统计
scramble --stats

# 验证配置
scramble --validate
```

## 📈 性能优化建议

### 1. 使用缓存
```bash
# 启用文件缓存（默认启用）
scramble --output=api.json

# 查看缓存统计
scramble --stats
```

### 2. 限制扫描范围
```bash
# 只扫描特定目录
scramble --controllers=app/api --models=app/model --output=api.json
```

### 3. 使用配置文件
```bash
# 使用配置文件避免重复参数
scramble --config=scramble.php --output=api.json
```

## 🔄 更新和维护

### 检查更新
```bash
# 查看当前版本
scramble --version

# 访问 GitHub Releases 页面检查新版本
# https://github.com/yangweijie/think-scramble/releases
```

### 重新安装
```bash
# Linux/macOS
sudo rm /usr/local/bin/scramble
sudo ./install.sh

# Windows
# 删除旧文件并重新运行 install.bat
```

## 📞 获取帮助

### 文档资源
- [GitHub Repository](https://github.com/yangweijie/think-scramble)
- [使用文档](docs/)
- [构建指南](docs/build.md)

### 问题反馈
- [GitHub Issues](https://github.com/yangweijie/think-scramble/issues)
- [讨论区](https://github.com/yangweijie/think-scramble/discussions)

### 社区支持
- 提交 Bug 报告
- 功能请求
- 贡献代码

---

🎉 **恭喜！** ThinkScramble 现在已经是一个完全独立的跨平台 CLI 工具，可以在任何支持 PHP 的系统上运行，无需额外依赖！
